(()=>{var e={};e.id=4290,e.ids=[4290],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33159:()=>{},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},73327:()=>{},89022:(e,r,t)=>{"use strict";t.r(r),t.d(r,{patchFetch:()=>m,routeModule:()=>p,serverHooks:()=>b,workAsyncStorage:()=>c,workUnitAsyncStorage:()=>l});var s={};t.r(s),t.d(s,{GET:()=>u,POST:()=>d});var o=t(2179),n=t(20540),a=t(57395),i=t(8306);async function u(e){try{let r=await Object(function(){var e=Error("Cannot find module '@/lib/session'");throw e.code="MODULE_NOT_FOUND",e}())();if(!r||!r.user)return i.NextResponse.json({error:"Unauthorized"},{status:401});let{searchParams:t}=new URL(e.url),s=t.get("ward"),o=t.get("category"),n=t.get("status"),a=await Object(function(){var e=Error("Cannot find module '@/lib/database'");throw e.code="MODULE_NOT_FOUND",e}())(),u="SELECT * FROM beds WHERE 1=1",d=[];s&&(u+=" AND ward = ?",d.push(s)),o&&(u+=" AND category = ?",d.push(o)),n&&(u+=" AND status = ?",d.push(n)),u+=" ORDER BY ward, room_number, bed_number";let p=await a.query(u,d);return i.NextResponse.json(p.results||[])}catch(r){console.error("Error fetching beds:",r);let e=r instanceof Error?r.message:"An unknown error occurred";return i.NextResponse.json({error:"Failed to fetch beds",details:e},{status:500})}}async function d(e){try{let r=await Object(function(){var e=Error("Cannot find module '@/lib/session'");throw e.code="MODULE_NOT_FOUND",e}())();if(!r||!r.user)return i.NextResponse.json({error:"Unauthorized"},{status:401});if(!r.user.permissions?.includes("bed:create"))return i.NextResponse.json({error:"Forbidden"},{status:403});let t=await e.json();for(let e of["bed_number","room_number","ward","category","price_per_day"])if(!t[e]||"string"==typeof t[e]&&!t[e].trim())return i.NextResponse.json({error:`Missing or empty required field: ${e}`},{status:400});if("number"!=typeof t.price_per_day||t.price_per_day<=0)return i.NextResponse.json({error:"Invalid price_per_day: must be a positive number"},{status:400});let s=await Object(function(){var e=Error("Cannot find module '@/lib/database'");throw e.code="MODULE_NOT_FOUND",e}())(),o=await s.query("SELECT id FROM beds WHERE bed_number = ? AND room_number = ? AND ward = ?",[t.bed_number,t.room_number,t.ward]);if(o.results&&o.results.length>0?o.results[0]:void 0)return i.NextResponse.json({error:"Bed number already exists in this room and ward"},{status:409});return await s.query(`
      INSERT INTO beds (bed_number, room_number, ward, category, status, price_per_day, features)
      VALUES (?, ?, ?, ?, ?, ?, ?)
    `,[t.bed_number,t.room_number,t.ward,t.category,t.status||"available",t.price_per_day,t.features||void 0]),i.NextResponse.json({message:"Bed created (mock operation)"},{status:201})}catch(r){console.error("Error creating bed:",r);let e=r instanceof Error?r.message:"An unknown error occurred";return i.NextResponse.json({error:"Failed to create bed",details:e},{status:500})}}!function(){var e=Error("Cannot find module '@/lib/database'");throw e.code="MODULE_NOT_FOUND",e}(),function(){var e=Error("Cannot find module '@/lib/session'");throw e.code="MODULE_NOT_FOUND",e}();let p=new o.AppRouteRouteModule({definition:{kind:n.RouteKind.APP_ROUTE,page:"/api/ipd/beds/route",pathname:"/api/ipd/beds",filename:"route",bundlePath:"app/api/ipd/beds/route"},resolvedPagePath:"/workspace/Hospital-Management-System/src/app/api/ipd/beds/route.ts",nextConfigOutput:"",userland:s}),{workAsyncStorage:c,workUnitAsyncStorage:l,serverHooks:b}=p;function m(){return(0,a.patchFetch)({workAsyncStorage:c,workUnitAsyncStorage:l})}}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[7395,6088],()=>t(89022));module.exports=s})();